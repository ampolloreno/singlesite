1.620494654599101e9
ERROR: LoadError: ArgumentError: Cannot create a dual over scalar type Complex{Float64}. If the type behaves as a scalar, define FowardDiff.can_dual.
Stacktrace:
 [1] throw_cannot_dual(::Type{T} where T) at /users/smith/anpo0771/.julia/packages/ForwardDiff/m7cm5/src/dual.jl:36
 [2] ForwardDiff.Dual{ForwardDiff.Tag{SciMLBase.UJacobianWrapper{ODEFunction{true,QuantumOptics.timeevolution.var"#df_#3"{QuantumOptics.timeevolution.var"#dschroedinger_#28"{Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}},var"#H#4"{Float64,Float64,Int64,Int64,Float64,Float64,Float64,SpinBasis{1//2,Int64}}},Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}},Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}}},LinearAlgebra.UniformScaling{Bool},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,typeof(SciMLBase.DEFAULT_OBSERVED),Nothing},Float64,SciMLBase.NullParameters},Complex{Float64}},Complex{Float64},2}(::Complex{Float64}, ::ForwardDiff.Partials{2,Complex{Float64}}) at /users/smith/anpo0771/.julia/packages/ForwardDiff/m7cm5/src/dual.jl:18
 [3] Dual at /users/smith/anpo0771/.julia/packages/ForwardDiff/m7cm5/src/dual.jl:55 [inlined]
 [4] Dual at /users/smith/anpo0771/.julia/packages/ForwardDiff/m7cm5/src/dual.jl:59 [inlined]
 [5] Dual at /users/smith/anpo0771/.julia/packages/ForwardDiff/m7cm5/src/dual.jl:62 [inlined]
 [6] _broadcast_getindex_evalf at ./broadcast.jl:648 [inlined]
 [7] _broadcast_getindex at ./broadcast.jl:621 [inlined]
 [8] getindex at ./broadcast.jl:575 [inlined]
 [9] copy at ./broadcast.jl:876 [inlined]
 [10] materialize(::Base.Broadcast.Broadcasted{Base.Broadcast.DefaultArrayStyle{1},Nothing,Type{ForwardDiff.Dual{ForwardDiff.Tag{SciMLBase.UJacobianWrapper{ODEFunction{true,QuantumOptics.timeevolution.var"#df_#3"{QuantumOptics.timeevolution.var"#dschroedinger_#28"{Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}},var"#H#4"{Float64,Float64,Int64,Int64,Float64,Float64,Float64,SpinBasis{1//2,Int64}}},Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}},Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}}},LinearAlgebra.UniformScaling{Bool},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,typeof(SciMLBase.DEFAULT_OBSERVED),Nothing},Float64,SciMLBase.NullParameters},Complex{Float64}},V,N} where N where V},Tuple{Array{Complex{Float64},1},Array{Tuple{Bool,Bool},1}}}) at ./broadcast.jl:837
 [11] SparseDiffTools.ForwardColorJacCache(::Function, ::Array{Complex{Float64},1}, ::Nothing; dx::Nothing, colorvec::UnitRange{Int64}, sparsity::Nothing) at /users/smith/anpo0771/.julia/packages/SparseDiffTools/AhWaW/src/differentiation/compute_jacobian_ad.jl:35
 [12] build_jac_config at /users/smith/anpo0771/.julia/packages/OrdinaryDiffEq/IOPED/src/derivative_wrappers.jl:122 [inlined]
 [13] alg_cache(::Rosenbrock23{0,true,DefaultLinSolve,DataType}, ::Array{Complex{Float64},1}, ::Array{Complex{Float64},1}, ::Type{T} where T, ::Type{T} where T, ::Type{T} where T, ::Array{Complex{Float64},1}, ::Array{Complex{Float64},1}, ::ODEFunction{true,QuantumOptics.timeevolution.var"#df_#3"{QuantumOptics.timeevolution.var"#dschroedinger_#28"{Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}},var"#H#4"{Float64,Float64,Int64,Int64,Float64,Float64,Float64,SpinBasis{1//2,Int64}}},Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}},Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}}},LinearAlgebra.UniformScaling{Bool},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,typeof(SciMLBase.DEFAULT_OBSERVED),Nothing}, ::Float64, ::Float64, ::Float64, ::SciMLBase.NullParameters, ::Bool, ::Val{true}) at /users/smith/anpo0771/.julia/packages/OrdinaryDiffEq/IOPED/src/caches/rosenbrock_caches.jl:79
 [14] __init(::ODEProblem{Array{Complex{Float64},1},Tuple{Float64,Float64},true,SciMLBase.NullParameters,ODEFunction{true,QuantumOptics.timeevolution.var"#df_#3"{QuantumOptics.timeevolution.var"#dschroedinger_#28"{Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}},var"#H#4"{Float64,Float64,Int64,Int64,Float64,Float64,Float64,SpinBasis{1//2,Int64}}},Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}},Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}}},LinearAlgebra.UniformScaling{Bool},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,typeof(SciMLBase.DEFAULT_OBSERVED),Nothing},Base.Iterators.Pairs{Union{},Union{},Tuple{},NamedTuple{(),Tuple{}}},SciMLBase.StandardODEProblem}, ::Rosenbrock23{0,true,DefaultLinSolve,DataType}, ::Tuple{}, ::Tuple{}, ::Tuple{}, ::Type{Val{true}}; saveat::Tuple{}, tstops::Tuple{}, d_discontinuities::Tuple{}, save_idxs::Nothing, save_everystep::Bool, save_on::Bool, save_start::Bool, save_end::Bool, callback::CallbackSet{Tuple{},Tuple{DiscreteCallback{DiffEqCallbacks.var"#30#31",DiffEqCallbacks.SavingAffect{QuantumOptics.timeevolution.var"#fout_#4"{Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}},QuantumOptics.timeevolution.var"#fout#7"{Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}}}},Float64,Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}},DataStructures.BinaryHeap{Float64,Base.Order.ForwardOrdering},Array{Float64,1}},typeof(DiffEqCallbacks.saving_initialize),typeof(DiffEqBase.FINALIZE_DEFAULT)}}}, dense::Bool, calck::Bool, dt::Float64, dtmin::Nothing, dtmax::Float64, force_dtmin::Bool, adaptive::Bool, gamma::Rational{Int64}, abstol::Float64, reltol::Float64, qmin::Rational{Int64}, qmax::Int64, qsteady_min::Int64, qsteady_max::Rational{Int64}, qoldinit::Rational{Int64}, fullnormalize::Bool, failfactor::Int64, beta1::Nothing, beta2::Nothing, maxiters::Int64, internalnorm::typeof(DiffEqBase.ODE_DEFAULT_NORM), internalopnorm::typeof(LinearAlgebra.opnorm), isoutofdomain::typeof(DiffEqBase.ODE_DEFAULT_ISOUTOFDOMAIN), unstable_check::typeof(DiffEqBase.ODE_DEFAULT_UNSTABLE_CHECK), verbose::Bool, timeseries_errors::Bool, dense_errors::Bool, advance_to_tstop::Bool, stop_at_next_tstop::Bool, initialize_save::Bool, progress::Bool, progress_steps::Int64, progress_name::String, progress_message::typeof(DiffEqBase.ODE_DEFAULT_PROG_MESSAGE), userdata::Nothing, allow_extrapolation::Bool, initialize_integrator::Bool, alias_u0::Bool, alias_du0::Bool, initializealg::OrdinaryDiffEq.DefaultInit, kwargs::Base.Iterators.Pairs{Union{},Union{},Tuple{},NamedTuple{(),Tuple{}}}) at /users/smith/anpo0771/.julia/packages/OrdinaryDiffEq/IOPED/src/solve.jl:294
 [15] __solve(::ODEProblem{Array{Complex{Float64},1},Tuple{Float64,Float64},true,SciMLBase.NullParameters,ODEFunction{true,QuantumOptics.timeevolution.var"#df_#3"{QuantumOptics.timeevolution.var"#dschroedinger_#28"{Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}},var"#H#4"{Float64,Float64,Int64,Int64,Float64,Float64,Float64,SpinBasis{1//2,Int64}}},Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}},Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}}},LinearAlgebra.UniformScaling{Bool},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,typeof(SciMLBase.DEFAULT_OBSERVED),Nothing},Base.Iterators.Pairs{Union{},Union{},Tuple{},NamedTuple{(),Tuple{}}},SciMLBase.StandardODEProblem}, ::Rosenbrock23{0,true,DefaultLinSolve,DataType}; kwargs::Base.Iterators.Pairs{Symbol,Any,NTuple{6,Symbol},NamedTuple{(:reltol, :abstol, :save_everystep, :save_start, :save_end, :callback),Tuple{Float64,Float64,Bool,Bool,Bool,CallbackSet{Tuple{},Tuple{DiscreteCallback{DiffEqCallbacks.var"#30#31",DiffEqCallbacks.SavingAffect{QuantumOptics.timeevolution.var"#fout_#4"{Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}},QuantumOptics.timeevolution.var"#fout#7"{Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}}}},Float64,Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}},DataStructures.BinaryHeap{Float64,Base.Order.ForwardOrdering},Array{Float64,1}},typeof(DiffEqCallbacks.saving_initialize),typeof(DiffEqBase.FINALIZE_DEFAULT)}}}}}}) at /users/smith/anpo0771/.julia/packages/OrdinaryDiffEq/IOPED/src/solve.jl:4
 [16] #solve_call#56 at /users/smith/anpo0771/.julia/packages/DiffEqBase/J25G4/src/solve.jl:61 [inlined]
 [17] #solve_up#58 at /users/smith/anpo0771/.julia/packages/DiffEqBase/J25G4/src/solve.jl:82 [inlined]
 [18] #solve#57 at /users/smith/anpo0771/.julia/packages/DiffEqBase/J25G4/src/solve.jl:70 [inlined]
 [19] integrate(::Array{Float64,1}, ::QuantumOptics.timeevolution.var"#dschroedinger_#28"{Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}},var"#H#4"{Float64,Float64,Int64,Int64,Float64,Float64,Float64,SpinBasis{1//2,Int64}}}, ::Array{Complex{Float64},1}, ::Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}}, ::Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}}, ::QuantumOptics.timeevolution.var"#fout#7"{Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}}}; alg::Rosenbrock23{0,true,DefaultLinSolve,DataType}, steady_state::Bool, tol::Float64, save_everystep::Bool, saveat::Array{Float64,1}, callback::Nothing, kwargs::Base.Iterators.Pairs{Union{},Union{},Tuple{},NamedTuple{(),Tuple{}}}) at /users/smith/anpo0771/.julia/packages/QuantumOptics/IPOQG/src/timeevolution_base.jl:57
 [20] #integrate#6 at /users/smith/anpo0771/.julia/packages/QuantumOptics/IPOQG/src/timeevolution_base.jl:73 [inlined]
 [21] #schroedinger_dynamic#27 at /users/smith/anpo0771/.julia/packages/QuantumOptics/IPOQG/src/schroedinger.jl:49 [inlined]
 [22] (::var"#evaluator#3"{Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}},Array{Float64,1},Float64,Float64,Float64,SpinBasis{1//2,Int64},StepRange{Int64,Int64}})(::Float64, ::Float64) at /users/smith/anpo0771/repos/singlesite/elliptical_job_solver.jl:116
 [23] (::var"#infidelity_polar#2"{var"#evaluator#3"{Ket{SpinBasis{1//2,Int64},Array{Complex{Float64},1}},Array{Float64,1},Float64,Float64,Float64,SpinBasis{1//2,Int64},StepRange{Int64,Int64}},typeof(gaussian_spin_profile)})(::Float64, ::Float64) at /users/smith/anpo0771/repos/singlesite/elliptical_job_solver.jl:101
 [24] top-level scope at /users/smith/anpo0771/repos/singlesite/elliptical_job_solver.jl:208
 [25] include(::Function, ::Module, ::String) at ./Base.jl:380
 [26] include(::Module, ::String) at ./Base.jl:368
 [27] exec_options(::Base.JLOptions) at ./client.jl:296
 [28] _start() at ./client.jl:506
in expression starting at /users/smith/anpo0771/repos/singlesite/elliptical_job_solver.jl:208
